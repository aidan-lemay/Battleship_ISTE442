<!DOCTYPE html>
<html>

<head>
    <title>Battleship - Chat</title>
    <link rel="stylesheet" href="./css/styles.css"></link>
    <script src="./js/chatFunction.js"></script>
</head>

<body onload="startChatClient()">
    <div class="center-body">
        <h1>Battleship - Lobby Chat</h1>
        <hr />

        <div class="barButtons">
            <div class="gameStart">
                <a class="gameStart" onclick="getGame()">START A NEW GAME</a>
            </div>
            
            <div class="logOut">
                <a class="logOut" onclick="signOut()">LOGOUT</a>
            </div>
        </div>
        
        <div class="chat-zone">
            <p class="status" id="userName">Logged In As: </p>

            <div class="chatbox" id="chatbox">
                <div id="messages"></div>
                <textarea name="msg" id="msgField" class="msgField"></textarea>
            </div>
            <p class="status" id="status"></p>
        </div>
        <div class="game-zone">
            <h3>Users Online:</h3>
            <hr>
            <a class="startGame" onclick="startGame()">Start Game With </a>
        </div>

    </div>

    <script type="text/javascript">
        function getGame() {
            location.href = '/game';
        }

        async function signOut() {
            (async () => {
                    const response = await fetch('http://localhost:3000/signOut', {
                        method: 'GET',
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    });
                        
                    if (response.status == 400) {
                        errorOutput.innerText = "All Inputs Are Required";
                    }
                    else if (response.status == 409) {
                        errorOutput.innerText = "Email Already Exists - Please Log In";
                    }
                    else if (response.status == 302) {
                        // const id = response._id;
                        // const token = response.token;
                        // const name = `${response.fName} ${response.lName}`;
                    }
                    else {
                        errorOutput.innerText = "An Error Occurred, Please Try Again";
                    }
                })();
        }
    </script>
</body>

</html>